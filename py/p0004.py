from time import perf_counter_ns as ns


def brute(arr, i=1):
    while True:
        if i not in arr:
            return i
        i += 1


def brute_for(arr):
    for i in range(1, int(1e24)):
        if i not in arr:
            return i


def pos_swap_cut_sort_find(arr):
    if not arr:
        return 1
    last_pos = 0
    for i, n in enumerate(arr):
        if n > 0:
            arr[i], arr[last_pos] = arr[last_pos], arr[i]
            last_pos += 1
    arr = arr[:last_pos]
    arr.sort()
    arr += [arr[-1] + 1]
    for i, n in enumerate(arr[:-1]):
        tmp = n - arr[i + 1]
        if tmp and tmp != -1:
            return n + 1
    return last_pos + 1


def pos_swap_mark_find(arr):
    if not arr:
        return 1
    positives = [0] * (max(arr) + 1)
    last_pos = 0
    for i, n in enumerate(arr):
        if n > 0:
            positives[n] = 1
            arr[i], arr[last_pos] = arr[last_pos], arr[i]
            last_pos += 1
    for i in range(1, last_pos):
        if not positives[i]:
            return i
    return last_pos + 1


tests = [
    ([3, 4, -1, 1], 2),
    ([1, 2, 0], 3),
    ([-2, 4, -3, 6, 3, 2, -7, 1, 7, -3], 5),
    ([i for i in range(2, 10)] + [500] * 10000 + [1] + [1000] * 10000 + [11], 10),
    ([444, 94, 408, 12, 313, 13, 70, 131, 433, 179, 150, 358, 309, 428, 68, 87, 43-296, -48, -225, -9, -14, -333, -89, -82, -267, -206, -252, -25, -320, -163, -129, -109, -154, -69, -138, -131, -303, -285, -117, -169, -334, -93, -199, -222, -34, -249, -119, -215, -258, -325, -329, -77, -336, -48, -51, -287, -286, -44, -125, -56, -219, -260, -25, -101, -178, -214, -297, -168, -319, -293, -102, -153, -208, -185, -56, -189, -119, -328, -125, -160, -175, -197, -191, -226, -176, -7, -237, -155, -299, -7, -246, -180, -62, -22, -69, -298, -179, -74, -343, -343, -19, -132, -78, -163, -228, -320, -350, -332, -183, -128, -165, -64, -239, -119, -64, -18, -315, -75, -137, -198, -218, -85, -173, -326, -276, -11, -306, -266, -341, -106, -194, -23, -213, -280, -349, -96, -326, -13, -104, -266, -239, -272, -327, -47, -345, -99, -165, -285, -333, -123, -165, -304, -257, -45, -10, -5, -16, -317, -279, -168, -180, -303, -183, -7, -278, -201, -53, -42, -346, -301, -117, -117, -105, -62, -25, -315, -72, -255, -211, -38, -134, -222, -292, -114, -148, -227, 298, 179, 274, 224, 421, 116, 35, 263, 341, 303, 289, 204, 134, 53, 448, 33, 208, 382, 208, 254, 377, 457, 339, 247, 383, 393, 52, 166, 186, 287, 438, 324, 90, 57, 17, 188, 236, 367, 132, 332, 168, 29, 280, 489, 253, 90, 119, 243, 225, 141, 411, 171, 177, 294, 97, 74, 151, 455, 374, 180, 341, 77, 293, 476, 168, 477, 389, 232, 22, 99, 123, 382, 279, 373, 88, 344, 101, 417, 207, 19, 51, 223, 362, 384, 494, 100, 270, 203, 404, 214, 203, 270, 281, 273, 451, 385, 114, 23, 418, 447, 343, 403, 8, 2, 257, 4, 341, 340, 117, 428, 43, 207, 68, 407, 408, 72, 451, 9, 455, 178, 184, 433, 109, 92, 405, 460, 237, 330, 223, 371, 263, 190, 437, 167, 406, 65, 358, 279, 241, 142, 292, 193, 112, 76, 91, 428, 45, 464, 107, 90, 465, 208, 236, 463, 284, 461, 387, 321, 196, 454, 46, 248, 126, 404, 434, 2, 20, 67, 299, 490, 490, 56, 202, 412, 111, 359, 255, 251, 493, 251, 413, 284, 238, 392, 373, 272, 453, 282, 62, 316, 404, 93, 403, 269, 450, 373, 469, 105, 218, 27, 415, 449, 132, 391, 26, 121, 449, 139, 459, 418, 81, 154, 132, 96, 15, 267, 306, 426, 471, 180, 72, 207, 282, 72, 139, 281, 467, 418, 233, 360, 24, 275, 295, 412, 135, 73, 121, 119, 287, 172, 58, 493, 376, 428, 401, 241, 52, 67, 290, 307, 123, 70, 311, 335, 116, 202, 354, 278, 20, 351, 62, 192, 133, 486, 370, 130, 389, 50, 389, 45, 495, 266, 135, 200, 333, 64, 228, 293, 419, 453, 189, 28, 319, 39, 23, 352, 275, 178, 123, 126, 375, 259, 290, 170, 341, 124, 338, 48, 55, 399, 351, 152, 351, 256, 328, 295, 387, 137, 230, 251, 231, 108, 239, 459, 202, 452, 32, 213, 159, 146, 138, 138, 19, 34, 448, 478, 38, 212, 468, 255, 113, 143, 76, 493, 354, 432, 336, 260, 308, 448, 492, 120, 275, 463, 210, 80, 41, 61, 46, 162, 422, 199, 332, 311, 390, 478, 308, 223, 291, 179, 293, 156, 139, 143, 465, 251, 383, 36, 427, 496, 29, 261, 265, 405, 423, 393, 72, 140, 52, 66, 207, 166, 292, 82, 325, 441, 76, 442, 79, 462, 489, 420, 86, 30, 196, 415, 313, 480, 239, 91, 124, 103, 229, 423, 208, 8, 458, 146, 228, 67, 367, 494, 260, 196, 353, 194, 316, 423, 330, 377, 328, 285, 464, 326, 105, 234, 266, 90, 310, 24, 329, 351, 29, 448, 65, 184, 113, 147, 25, 71, 23, 483, 27, 78, 487, 397, 193, 420, 5, 428, 217, 401, 34, 391, 107, 163, 22, 356, 3, 173, 243, 44, 29, 431, 463, 329, 106, 179, 125, 68, 60, 252, 293, 388, 411, 296, 172, 143, 296, 259, 100, 218, 335, 33, 476, 341, 156, 46, 52, 465, 348, 78, 336, 299, 168, 97, 178, 385, 463, 261, 31, 182, 262, 228, 64, 412, 412, 369, 397, 304, 99, 313, 376, 492, 67, 289, 267, 180, 496, 69, 485, 148, 284, 486, 160, 422, 111, 394, 161, 458, 428, 135, 173, 239, 471, 392, 333, 328, 73, 83, 198, 120, 145, 41, 463, 248, 92, 444, 336, 388, 56, 275, 273, 386, 415, 247, 345, 495, 96, 374, 349, 209, 375, 469, 156, 101, 292, 354, 465, 173, 35, 466, 491, 88, 284, 140, 408, 323, 46, 432, 328, 465, 136, 172, 236, 314, 161, 443, 27, 160, 266, 457, 285, 451, 1, 49, 426, 234, 432, 261, 11, 61, 311, 495, 427, 114, 29, 38, 293, 96, 315, 359, 25, 435, 147, 269, 25, 172, 25, 113, 280, 158, 1, 407, 425, 489, 322, 444, 391, 6, 498, 443, 82, 331, 398, 181, 194, 383, 191, 452, 11, 351, 174, 286, 407, 261, 249, 217, 39, 395, 320, 147, 33, 353, 304, 121, 71, 247, 141, 397, 23, 96, 108, 330, 260, 287, 159, 191, 444, 227, 295, 235, 347, 390, 270, 169, 414, 112, 118, 229, 486, 149, 407, 305, 436, 175, 440, 449, 170, 476, 128, 250, 19, 281, 469, 172, 22, 122, 183, 474, 189, 341, 438, 100, 151, 497, 377, 220, 306, 154, 214, 235, 307, 41, 448, 173, 37, 352, 426, 447, 79, 343, 257, 23, 224, 472, 75, 120, 59, 357, 151, 38, 63, 303, 340, 0, 343, 229, 440, 348, 461, 126, 128, 79, 434, 440, 483, 79, 103, 134, 30, 128, 115, 316, 402, 7, 77, 342, 210, 486, 443, 110, 157, 313, 464, 443, 295, 176, 236, 381, 340, 333, 356, 34, 349, 420, 119, 478, 23, 468, 131, 397, 80, 165, 492, 380, 383, 420, 243, 491, 208, 437, 322, 316, 97, 435, 236, 243, 183, 207, 343, 349, 262, 93, 19, 429, 421, 8, 302, 398, 77, 300, 491, 99, 93, 403, 166, 432, 294, 52, 255, 159, 80, 337, 198, 410, 231, 326, 206, 437, 315, 417, 73, 480, 452, 342, 95, 256, 408, 338, 18, 273, 463, 133, 141, 57, 144, 219, 337, 415-296, -48, -225, -9, -14, -333, -89, -82, -267, -206, -252, -25, -320, -163, -129, -109, -154, -69, -138, -131, -303, -285, -117, -169, -334, -93, -199, -222, -34, -249, -119, -215, -258, -325, -329, -77, -336, -48, -51, -287, -286, -44, -125, -56, -219, -260, -25, -101, -178, -214, -297, -168, -319, -293, -102, -153, -208, -185, -56, -189, -119, -328, -125, -160, -175, -197, -191, -226, -176, -7, -237, -155, -299, -7, -246, -180, -62, -22, -69, -298, -179, -74, -343, -343, -19, -132, -78, -163, -228, -320, -350, -332, -183, -128, -165, -64, -239, -119, -64, -18, -315, -75, -137, -198, -218, -85, -173, -326, -276, -11, -306, -266, -341, -106, -194, -23, -213, -280, -349, -96, -326, -13, -104, -266, -239, -272, -327, -47, -345, -99, -165, -285, -333, -123, -165, -304, -257, -45, -10, -5, -16, -317, -279, -168, -180, -303, -183, -7, -278, -201, -53, -42, -346, -301, -117, -117, -105, -62, -25, -315, -72, -255, -211, -38, -134, -222, -292, -114, -148, -227, 496, 459, 361, 306, 316, 115, 117, 385, 122, 178, 51, 245, 17, 191, 303, 220, 355, 292, 103, 185, 148, 386, 85, 328, 211, 429, 374, 428, 420, 387, 39, 125, 424, 415, 144, 105, 243, 299, 60, 453, 356, 42, 325, 58, 411, 214, 117, 325, 199, 404, 55, 162, 332, 414, 0, 495, 389, 116, 460, 222, 427, 389, 392, 273, 72, 144, 307, 408, 225, 190, 271, 133, 451, 274, 278, 476, 138, 25, 379, 346, 252, 142, 341, 19, 481, 307, 379, 234, 319, 111, 353, 119, 397, 11, 212, 486, 125, 344, 10, 153, 237, 295, 82, 28, 344, 217, 147, 478, 400, 299, 27, 287, 45, 365, 117, 364, 356, 451, 451, 478, 282, 140, 259, 96, 442, 200, 7, 396, 484, 133, 47, 332, 219, 219, 175, 235, 341, 262, 47, 64, 359, 431, 78, 250, 197, 337, 105, 435, 416, 311, 427, 37, 319, 359, 128, 55, 22, 316, 185, 314, 235, 4, 401, 71, 251, 224, 107, 40, 71, 224, 115, 205, 433, 207, 208, 488, 292, 321, 188, 236, 436, 314, 21, 221, 120, 211, 297, 388, 105, 362, 358, 127, 390, 462, 137, 304, 491, 417, 256, 489, 307, 266, 90, 500, 262, 85, 271, 322, 479, 276, 10, 310, 398, 368, 180, 396, 486, 471, 347, 268, 66, 127, 78, 437, 499, 66, 102, 239, 237, 179, 322, 21, 117, 28, 121, 83, 52, 202, 456, 321, 177, 73, 369, 278, 383, 5, 244, 476, 398, 226, 219, 51, 173, 303, 107, 205, 75, 184, 0, 430, 27, 71, 67, 79, 243, 486, 216, 264, 441, 394, 233, 248, 228, 36, 20, 437, 120, 62, 206, 391, 244, 177, 163, 435, 80, 233, 281, 315, 233, 338, 71, 403, 162, 200, 454, 381, 74, 433, 42, 152, 20, 295, 64, 180, 223, 492, 15, 500, 354, 106, 442, 209, 448, 46, 23, 461, 228, 485, 228, 118, 51, 55, 313, 189, 201, 99, 417, 245, 171, 292, 134, 102, 304, 204, 415, 258, 268, 72, 53, 488, 484, 213, 486, 308, 172, 391, 103, 61, 288, 280, 48, 463, 35, 278, 234, 487, 260, 442, 117, 42, 468, 260, 24, 417, 344, 60, 41, 306, 323, 288, 432, 359, 318, 23, 449, 196, 223, 208, 199, 78, 376, 364, 103, 167, 425, 135, 314, 418, 490, 462, 297, 299, 451, 460, 445, 233, 306, 236, 168, 61, 447, 168, 259, 453, 220, 63, 337, 489, 145, 237, 322, 3, 237, 251, 420, 30, 71, 57, 255, 62, 106, 490, 454, 58, 193, 204, 311, 341, 397, 272, 84, 21, 410, 366, 477, 276, 182, 55, 16, 410, 407, 437, 187, 10, 347, 141, 70, 437, 2, 381, 209, 199, 328, 283, 428, 343, 81, 129, 461, 344, 247, 215, 303, 498, 22, 2, 459, 174, 253, 61, 434, 371, 209, 132, 82, 25, 189, 57, 488, 224, 223, 270, 246, 244, 112, 291, 305, 7, 481, 89, 347, 41, 10, 341, 437, 318, 294, 310, 98, 240, 39, 397, 75, 216, 322, 263, 285, 345, 292, 48, 192, 164, 353, 3, 155, 201, 384, 100, 173, 327, 149, 155, 459, 450, 494, 174, 181, 384, 47, 120, 143, 414, 405, 382, 309, 442, 382, 67, 214, 385, 458, 452, 283, 76, 289, 100, 387, 54, 190, 261, 255, 370, 264, 62, 5, 155, 2, 470, 287, 101, 197, 263, 146, 49, 441, 15, 457, 488, 202, 121, 437, 56, 20, 493, 317, 69, 477, 489, 159, 402, 428, 281, 385, 327, 344, 171, 103, 217, 28, 304, 367, 281, 91, 322, 136, 112, 322, 470, 482, 285, 277, 80, 264, 347, 418, 29, 184, 42, 457, 396, 465, 498, 467, 60, 410, 412, 148, 282, 448, 189, 162, 487, 342, 447, 123, 166, 496, 424, 303, 361, 329, 329, 3, 261, 62, 286, 106, 288, 387, 319, 489, 303, 431, 447, 245, 242, 246, 237, 195, 201, 46, 439, 161, 189, 245, 182, 217, 149, 244, 76, 414, 313, 3, 196, 44, 429, 28, 256, 165, 304, 223, 141, 241, 272, 130, 420, 459, 260, 486, 315, 496, 357, 449, 265, 31, 32, 313, 482, 416, 183, 136, 171, 169, 111, 101, 291, 275, 0, 112, 70, 390, 106, 54, 395, 433, 319, 422, 311, 465, 202, 22, 179, 440, 100, 47, 291, 331, 282, 419, 383, 299, 270, 497, 19, 57, 62, 149, 325, 285, 160, 450, 163, 14, 446, 228, 447, 417, 148, 202, 354, 209, 477, 46, 282, 247, 217, 73, 368, 145, 475, 5, 378, 248, 177, 103, 480, 96, 185, 127, 379, 325, 310, 22, 441, 284, 494, 181, 425, 284, 58, 71, 33, 467, 385, 85, 64, 260, 207, 316, 70, 437, 66, 475, 391, 472, 165, 149, 218, 397, 375, 47, 271, 150, 90, 184, 462, 138, 159, 38, 105, 329, 133, 20, 355, 95, 365, 361, 219, 341, 312, 381, 257, 228, 278, 273, 373, 288, 267, 205, 252, 41, 73, 219, 198, 107, 221, 21, 63, 100, 199, 432, 51, 268, 231, 386, 402, 118, 108, 50, 471, 181, 58, 364, 429, 156, 478, 310, 168, 388, 432, 465, 102, 449, 104, 317, 488, 476, 175, 471, 333, 154, 279, 385, 59, 437, 272, 160, 457, 46, 446, 457, 57, 175, 457, 59, 0, 380, 46, 374, 310, 489, 304, 326, 169, 257, 110, 455, 322, 411, 43, 406, 349, 457, 246, 191, 131, 166, 464, 336, 136, 119, 303, 213, 50, 55, 412, 184, 360, 240, 343, 123, 333, 380, 432, 468, 313, 21, 368, 499, 366, 97, 266, 126, 27, 127, 452, 107, 112, 366, 418, 113, 127, 472, 411, 211, 255, 100, 317, 129, 250, 134, 108, 142, 290, 200, 22, 302, 188, 330, 250, 49, 491, 253, 189, 419, 344, 408, 426, 0, 213, 107, 242, 155, 309, 119, 26, 275, 57, 24, 246, 294, 392, 177, 116, 50, 321, 268, 77, 15, 172, 31, 74, 108, 16, 487, 271, 213, 35, 402, 153, 479, 130, 199, 95, 362, 349, 428, 171, 489, 262, 231, 465, 370, 24, 75, 136, 263, 96, 397, 78, 346, 177, 153, 125, 442, 45, 281, 344, 102, 34, 126, 219, 156, 446, 132, 414, 340, 424, 338, 23, 257, 203, 79, 3, 304, 24, 185, 206, 73, 351, 16, 424, 235, 303, 384, 214, 265, 216, 294, 201, 351, 83, 85, 104, 500, 146, 272, 319, 59, 85, 191, 316, 376, 273, 383, 23, 394, 137, 462, 289, 120, 42, 111, 481, 294, 69, 355, 171, 415, 406, 173, 472, 297, 372, 466, 282, 89, 6, 119, 350, 400, 455, 450, 171, 24, 389, 149, 11, 140, 220, 310, 477, 424, 372, 399, 30, 318, 330, 463, 302, 358, 300, 11, 268, 427, 423, 218, 441, 460, 211, 444, 69, 25, 396, 373, 409, 466, 194, 189, 363, 25, 371, 424, 334, 406, 190, 214, 307, 44, 386, 301, 293, 286], 473)
]

f = {'brute': [], 'brute_for': [], 'pos_swap_cut_sort_find': [], 'pos_swap_mark_find': []}
for n, expected in tests:
    start = ns()
    brute(n)
    end = ns()
    f['brute'].append(end - start)
    start = ns()
    brute_for(n)
    end = ns()
    f['brute_for'].append(end - start)
    start = ns()
    pos_swap_cut_sort_find(n)
    end = ns()
    f['pos_swap_cut_sort_find'].append(end - start)
    start = ns()
    pos_swap_mark_find(n)
    end = ns()
    f['pos_swap_mark_find'].append(end - start)
    if brute(n) != brute_for(n) or pos_swap_cut_sort_find(n) != expected or pos_swap_mark_find(n) != expected:
        print('wrong answer')
print(f'brute(): {f["brute"]}\n'
      f'brute_for(): {f["brute_for"]}\n'
      f'pos_swap_cut_sort_find(): {f["pos_swap_cut_sort_find"]}\n'
      f'pos_swap_mark_find(): {f["pos_swap_mark_find"]}')
